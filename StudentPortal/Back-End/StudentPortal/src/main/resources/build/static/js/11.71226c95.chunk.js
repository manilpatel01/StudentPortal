(this.webpackJsonpfront_ldce=this.webpackJsonpfront_ldce||[]).push([[11],{300:function(e,t){},311:function(e,t){},312:function(e,t){},333:function(e,t,a){"use strict";a.r(t);var n=a(21),l=a.n(n),r=a(260),c=a(31),s=a(26),o=a(0),u=a.n(o),i=a(306),m=a.n(i),f=a(11),d=a.n(f),b=a(45);var p=function(e){var t=e.tableHeader;return u.a.createElement("div",{class:"table-responsive"},u.a.createElement("table",{class:"table table-bordered table-hover",id:"table-to-xls"},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Sr No."),t.map((function(e){return u.a.createElement("th",null,e)})))),u.a.createElement("tbody",null,e.fields.map((function(e,a){return u.a.createElement("tr",{key:e.enrollment},u.a.createElement("td",null,a+1),t.map((function(t){return"gender"===t?u.a.createElement("td",null,"Male"===e[t]?"male":"female"):u.a.createElement("td",null,e[t])})))})))))},E=a(12);t.default=function(){var e=Object(o.useState)(),t=Object(s.a)(e,2),a=t[0],n=t[1],i=Object(o.useState)("Select Excel File"),f=Object(s.a)(i,2),v=f[0],g=f[1],x=Object(o.useState)(),h=Object(s.a)(x,2),S=h[0],y=h[1],O=Object(o.useState)(),j=Object(s.a)(O,2),F=j[0],N=j[1],w=Object(o.useState)({}),_=Object(s.a)(w,2),k=_[0],A=_[1],B=Object(o.useState)([]),H=Object(s.a)(B,2),I=H[0],L=H[1];Object(o.useEffect)((function(){console.log(typeof a),a&&console.log(a)}),[a]);var J=function(){var e=Object(c.a)(l.a.mark((function e(t){var a,c,s,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files[0],c=["xlsx","xls","csv"],s=a.name.split(".").pop(),!(c.indexOf(s)<0)){e.next=8;break}return y("Only Excel File Allow!!"),g("Select Excel File"),n(),e.abrupt("return");case 8:y(),g(a.name),(o=new FileReader).onload=function(e){var t=e.target.result;t=new Uint8Array(t);var a=m.a.read(t,{type:"array"});console.log(a);var l={};a.SheetNames.forEach((function(e){l=m.a.utils.sheet_to_json(a.Sheets[e],{header:1})})),console.log(l);var c=[];l[0]=Object(r.a)(l[0]).map((function(e){return e.trim()})),L(Object(r.a)(l[0]));for(var s=1;s<l.length;s++){var o={};for(var u in l[s]){o[l[0][u]]=l[s][u]}console.log(o),c.push(o)}n({excelStudentList:c})},o.readAsArrayBuffer(a);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return u.a.createElement("div",{className:"container"},u.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),!a)return y("Plese Select Excel File First!!"),n(),void document.getElementById("ExcelForm").reset();N(!0),d.a.post(E.a.importExcel(),a).then((function(e){console.log(e.data),A({type:"success",msg:e.data.Success}),N(!1),n(),L([]),document.getElementById("ExcelForm").reset()})).catch((function(e){console.log(e.response),A({type:"danger",msg:e.response.data&&"Something Went Wrong!!"}),N(!1)}))},id:"ExcelForm"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-lg-6 mt-lg-5 mx-auto"},u.a.createElement("div",{className:"custom-file"},u.a.createElement("input",{type:"file",accept:".xlsx, .xls, .csv",className:"custom-file-input",id:"excelFile",onChange:J}),u.a.createElement("label",{className:"custom-file-label",htmlFor:"excelFile"},v),u.a.createElement("label",{className:"error",dangerouslySetInnerHTML:{__html:S}})))),u.a.createElement("div",{className:"form-group mt-3 text-center"},u.a.createElement("button",{type:"submit",className:"btn btn-success"},"Submit")),!0===F?u.a.createElement(b.a,null):k.msg&&u.a.createElement("div",{className:"alert alert-".concat(k.type),style:{textAlign:"center"}},k.msg)),void 0!==a&&u.a.createElement(p,{fields:a.excelStudentList,tableHeader:I}))}}}]);
//# sourceMappingURL=11.71226c95.chunk.js.map