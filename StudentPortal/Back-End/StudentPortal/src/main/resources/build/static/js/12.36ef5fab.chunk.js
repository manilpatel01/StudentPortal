(this.webpackJsonpfront_ldce=this.webpackJsonpfront_ldce||[]).push([[12],{255:function(e,t){},307:function(e,t){},308:function(e,t){},327:function(e,t,a){"use strict";a.r(t);var n=a(20),l=a.n(n),c=a(205),r=a(38),s=a(182),o=a(0),u=a.n(o),i=a(302),m=a.n(i),f=a(7),d=a.n(f),b=a(48);var p=function(e){var t=e.tableHeader;return u.a.createElement("div",{class:"table-responsive"},u.a.createElement("table",{class:"table table-bordered table-hover",id:"table-to-xls"},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",null,"Sr No."),t.map((function(e){return u.a.createElement("th",null,e)})))),u.a.createElement("tbody",null,e.fields.map((function(e,a){return u.a.createElement("tr",{key:e.enrollment},u.a.createElement("td",null,a+1),t.map((function(t){return"gender"===t?u.a.createElement("td",null,"M"===e[t]?"male":"female"):u.a.createElement("td",null,e[t])})))})))))};t.default=function(){var e=Object(o.useState)(),t=Object(s.a)(e,2),a=t[0],n=t[1],i=Object(o.useState)("Select Excel File"),f=Object(s.a)(i,2),E=f[0],v=f[1],g=Object(o.useState)(),x=Object(s.a)(g,2),h=x[0],S=x[1],O=Object(o.useState)(),j=Object(s.a)(O,2),y=j[0],N=j[1],F=Object(o.useState)({}),w=Object(s.a)(F,2),_=w[0],k=w[1],A=Object(o.useState)([]),H=Object(s.a)(A,2),L=H[0],J=H[1];Object(o.useEffect)((function(){console.log(typeof a),a&&console.log(a)}),[a]);var M=function(){var e=Object(r.a)(l.a.mark((function e(t){var a,r,s,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files[0],r=["xlsx","xls","csv"],s=a.name.split(".").pop(),!(r.indexOf(s)<0)){e.next=8;break}return S("Only Excel File Allow!!"),v("Select Excel File"),n(),e.abrupt("return");case 8:S(),v(a.name),(o=new FileReader).onload=function(e){var t=e.target.result;t=new Uint8Array(t);var a=m.a.read(t,{type:"array"});console.log(a);var l={};a.SheetNames.forEach((function(e){l=m.a.utils.sheet_to_json(a.Sheets[e],{header:1})})),console.log(l);var r=[];console.log(l[0]),J(Object(c.a)(l[0]));for(var s=1;s<l.length;s++){var o={};for(var u in l[s])o[l[0][u]]=l[s][u];r.push(o)}n({excelStudentList:r})},o.readAsArrayBuffer(a);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return u.a.createElement("div",{className:"container"},u.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),!a)return S("Plese Select Excel File First!!"),void n();N(!0),d.a.post("/api/importExcel",a).then((function(e){console.log(e.data),k({type:"success",msg:e.data.Success}),N(!1),n(),J([])})).catch((function(e){console.log(e.response),k({type:"danger",msg:e.response.data&&"Something Went Wrong!!"}),N(!1)}))},id:"ExcelForm"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-lg-6 mt-lg-5 mx-auto"},u.a.createElement("div",{className:"custom-file"},u.a.createElement("input",{type:"file",accept:".xlsx, .xls, .csv",className:"custom-file-input",id:"excelFile",onChange:M}),u.a.createElement("label",{className:"custom-file-label",htmlFor:"excelFile"},E),u.a.createElement("label",{className:"error",dangerouslySetInnerHTML:{__html:h}})))),u.a.createElement("div",{className:"form-group mt-3 text-center"},u.a.createElement("button",{type:"submit",className:"btn btn-success"},"Submit")),!0===y?u.a.createElement(b.a,null):_.msg&&u.a.createElement("div",{className:"alert alert-".concat(_.type),style:{textAlign:"center"}},_.msg)),void 0!==a&&u.a.createElement(p,{fields:a.excelStudentList,tableHeader:L}))}}}]);
//# sourceMappingURL=12.36ef5fab.chunk.js.map